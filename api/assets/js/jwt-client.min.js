!function(e,t){"object"==typeof exports?module.exports=t:"function"==typeof define&&define.amd?define([],function(){return t(e)}):window.JWT=t(e)}(this,function(e){function t(e){return"string"==typeof e||e&&"object"==typeof e&&"[object String]"==Object.prototype.toString.call(e)||!1}function n(e,n){return e&&!t(e)&&(n=e,e=void 0),{key:e||r.defaults.key,storage:n||r.defaults.storage}}var r={};return r.defaults={key:"JWT_TOKEN",tokenPrefix:"Bearer ",storage:e.localStorage,padding:!1},r.encode64=function(t){var n=e.btoa(e.unescape(e.encodeURIComponent(t)));return r.defaults.padding?n:n.replace(/=+$/,"")},r.decode64=function(t){return e.decodeURIComponent(e.escape(e.atob(t)))},r.write=function(e){return r.defaults.tokenPrefix+r.encode64(JSON.stringify(e.header))+"."+r.encode64(JSON.stringify(e.claim))+"."+(e.signature||"")},r.read=function(e){0===e.indexOf(r.defaults.tokenPrefix)&&(e=e.substring(r.defaults.tokenPrefix.length));var t=e.split(".");return{header:JSON.parse(r.decode64(t[0])),claim:JSON.parse(r.decode64(t[1])),signature:t[2]||""}},r.validateClaim=function(e,t,n){var r=Date.now()/1e3;return e&&(!e.exp||e.exp>r)&&(!e.nbf||e.nbf<r)&&(void 0===t||t===e.iss)&&(void 0===n||n===e.aud)},r.validate=function(e,n,o){return t(e)&&(e=r.read(e)),e&&e.claim&&r.validateClaim(e.claim,n,o)},r.set=function(e,t,r){var o=n(t,r);return o.storage.setItem(o.key,e)},r.get=function(e,t){var r=n(e,t);return r.storage.getItem(r.key)},r.remove=function(e,t){var r=n(e,t);return r.storage.removeItem(r.key)},r.keep=function(e,n,o){return r.set(t(e)?e:r.write(e),n,o)},r.remember=function(e,t){var n=r.get(e,t);return n&&r.read(n)},r.forget=r.remove,r});